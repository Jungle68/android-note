import{_ as n,o as s,c as a,e as t}from"./app.89e8a229.js";const p={},o=t(`<h1 id="\u83B7\u53D6\u8054\u7CFB\u4EBA" tabindex="-1"><a class="header-anchor" href="#\u83B7\u53D6\u8054\u7CFB\u4EBA" aria-hidden="true">#</a> \u83B7\u53D6\u8054\u7CFB\u4EBA</h1><p><code>Android</code>\u7CFB\u7EDF\u4E2D\u7684\u8054\u7CFB\u4EBA\u4E5F\u662F\u901A\u8FC7<code>ContentProvider</code>\u6765\u5BF9\u5916\u63D0\u4F9B\u6570\u636E\u7684 \u6570\u636E\u5E93\u8DEF\u5F84\u4E3A\uFF1A<code>/data/data/com.android.providers.contacts/database/contacts2.db</code> \u6211\u4EEC\u9700\u8981\u5173\u6CE8\u7684\u67093\u5F20\u8868</p><ul><li>raw_contacts\uFF1A\u5176\u4E2D\u4FDD\u5B58\u4E86\u8054\u7CFB\u4EBAid</li><li>data\uFF1A\u548Craw_contacts\u662F\u591A\u5BF9\u4E00\u7684\u5173\u7CFB\uFF0C\u4FDD\u5B58\u4E86\u8054\u7CFB\u4EBA\u7684\u5404\u9879\u6570\u636E</li><li>mimetypes\uFF1A\u4E3A\u6570\u636E\u7C7B\u578B</li></ul><p>\u5148\u67E5\u8BE2<code>raw_contacts</code>\u5F97\u5230\u6BCF\u4E2A\u8054\u7CFB\u4EBA\u7684<code>id</code>\uFF0C\u5728\u4F7F\u7528<code>id</code>\u4ECE<code>data</code>\u8868\u4E2D\u67E5\u8BE2\u5BF9\u5E94\u6570\u636E\uFF0C\u6839\u636E<code>mimetype</code>\u5206\u7C7B\u6570\u636E\u8FD9\u5730\u65B9\u5728\u6570\u636E\u5E93\u4E2D\u7684\u662F\u4E00\u4E2A<code>mimetype_id</code> \u662F\u4E00\u4E2A\u5916\u952E\u5F15\u7528\u5230\u4E86<code>mimetype</code>\u8FD9\u4E2A\u8868\u4E2D\uFF0C\u5B83\u5185\u90E8\u505A\u4E86\u4E00\u4E2A\u5173\u8054\u67E5\u8BE2\uFF0C\u8FD9\u5730\u65B9\u4E0D\u80FD\u5199<code>mimetype_id</code>\uFF0C\u53EA\u80FD\u5199<code>mimetype</code>\u4E0D\u7136\u4F1A\u62A5\u9519</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u83B7\u53D6\u8054\u7CFB\u4EBA
 * <span class="token keyword">@return</span>
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContactInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getContactInfos</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">ContentResolver</span> resolver <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Uri</span> uri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://com.android.contacts/raw_contacts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Uri</span> dataUri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://com.android.contacts/data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContactInfo</span><span class="token punctuation">&gt;</span></span> contactInfos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContactInfo</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;contact_id&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> id <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">ContactInfo</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContactInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Cursor</span> dataCursor <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>dataUri<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
					<span class="token string">&quot;mimetype&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;data1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;raw_contact_id=?&quot;</span><span class="token punctuation">,</span>
					<span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>dataCursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;vnd.android.cursor.item/name&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span> dataCursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					info<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>dataCursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;vnd.android.cursor.item/phone_v2&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span> dataCursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					info<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span>dataCursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			contactInfos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
			dataCursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> contactInfos<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8981\u4F7F\u7528\u5230\u8FD9\u4E09\u4E2A\u8868\uFF0C\u4F46\u662F\u8C37\u6B4C\u5185\u90E8\u5728\u67E5\u8BE2\u8FD9\u4E2A<code>data</code>\u8868\u7684\u65F6\u5019\u5185\u90E8\u4F7F\u7528\u7684\u5E76\u4E0D\u662F\u67E5\u8BE2<code>data</code>\u8868\u800C\u662F\u67E5\u8BE2\u4E86<code>data</code>\u8868\u7684\u89C6\u56FE\uFF0C \u8FD9\u4E2A\u89C6\u56FE\u4E2D\u76F4\u63A5\u5C06<code>mime_Type</code>\u7C7B\u578B\u7ED9\u5173\u8054\u597D\u4E86\uFF0C\u6240\u4EE5\u8FD9\u91CC\u76F4\u63A5\u67E5\u8BE2\u7684\u5C31\u662F<code>mimetype</code>\u8FD9\u4E2A\u7C7B\u578B\u5C31\u53EF\u4EE5\u4E86\uFF0C \u8FD8\u6709\u5C31\u662F\u5982\u679C\u81EA\u5DF1\u7684\u624B\u673A\u4E2D\u5982\u679C\u5220\u9664\u4E86\u4E00\u4E2A\u8054\u7CFB\u4EBA\u5728\u67E5\u8BE2\u7684\u65F6\u5019\u5C31\u4F1A\u62A5\u9519\uFF0C\u8FD9\u91CC\u56E0\u4E3A\u662F\u5728\u624B\u673A\u4E2D\u5220\u9664\u4E00\u4E2A\u8054\u7CFB\u4EBA\u7684\u65F6\u5019\u5E76<em>\u4E0D\u662F\u6E05\u7A7A\u6570\u636E\u5E93\u4E2D\u7684\u6570\u636E</em>\uFF0C \u800C\u662F\u5C06\u8FD9\u4E2A<strong>raw_contacks\u4E2D\u7684id\u7F6E\u4E3Anull</strong>\uFF0C\u6240\u4EE5\u4F1A\u62A5\u9519\uFF0C\u8FD9\u91CC\u5C31\u8981\u8FDB\u884C\u5224\u65AD\u4E00\u4E0B\u67E5\u51FA\u6765\u7684id\u662F\u5426\u4E3Anull\u3002</p><hr><ul><li>\u90AE\u7BB1 \uFF1Acharon.chui@gmail.com</li><li>Good Luck!</li></ul>`,8),c=[o];function e(u,l){return s(),a("div",null,c)}var k=n(p,[["render",e],["__file","\u83B7\u53D6\u8054\u7CFB\u4EBA.html.vue"]]);export{k as default};
