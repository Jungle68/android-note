import{_ as n,o as s,c as a,e as t}from"./app.e2a3b496.js";const p={},e=t(`<h1 id="\u641C\u7D22\u6846" tabindex="-1"><a class="header-anchor" href="#\u641C\u7D22\u6846" aria-hidden="true">#</a> \u641C\u7D22\u6846</h1><ol><li><p>\u5728res-xml\u4E2D\u65B0\u5EFA\u4E00\u4E2Asearchable.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
&lt;searchable xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
	android:label=&quot;@string/sms_search&quot;
	android:hint=&quot;@string/sms_search&quot; 
	android:searchSuggestAuthority=&quot;com.charon.MyProvider&quot;//\u81EA\u5B9A\u4E49\u7684Provider
	android:searchSuggestSelection=&quot; ?&quot; &gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>searchable</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u521B\u5EFA\u4E00\u4E2A\u641C\u7D22\u7684Activity\uFF0C\u5E76\u4E14\u5728\u6E05\u5355\u6587\u4EF6\u4E2D\u8FDB\u884C\u914D\u7F6E\uFF0C\u8FD9\u4E2AActivity\u5C31\u662F\u70B9\u51FB\u641C\u7D22\u7ED3\u679C\u540E\u7684\u9875\u9762(\u663E\u793A\u641C\u7D22\u7ED3\u679C\u7684Activity)</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activity</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.SearchableActivity<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.intent.action.SEARCH<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span>
            <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.app.searchable<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@xml/searchable<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activity</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5728\u8FD9\u4E2AActivity\u4E2D\u7684\u5185\u5BB9\u8981\u8FD9\u6837</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5982\u679C\u662F\u4ECE\u641C\u7D22\u5F00\u542F\u7684\u8FD9\u4E2A\u9875\u9762\u5C31\u83B7\u53D6\u5230\u641C\u7D22\u6846\u4E2D\u8F93\u5165\u7684\u5185\u5BB9</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span>ACTION_SEARCH<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>intent<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	<span class="token comment">//\u83B7\u53D6\u5230\u5728\u641C\u7D22\u6846\u4E2D\u8F93\u5165\u7684\u5185\u5BB9      </span>
    <span class="token class-name">String</span> query <span class="token operator">=</span> intent<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token class-name">SearchManager</span><span class="token punctuation">.</span>QUERY<span class="token punctuation">)</span><span class="token punctuation">;</span>    
	<span class="token comment">//\u6267\u884C\u641C\u7D22\u7684\u65B9\u6CD5 </span>
    <span class="token function">doMySearch</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>   
    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;i&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; query &quot;</span> <span class="token operator">+</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u5982\u4F55\u5B9E\u73B0\u5728\u8F93\u5165\u6846\u4E2D\u8F93\u5165\u5185\u5BB9\u540E\u4E0B\u9762\u5C31\u7ACB\u9A6C\u63D0\u793A\u76F8\u5E94\u7684\u641C\u7D22\u7ED3\u679C\u5462\uFF1F\u8981\u901A\u8FC7Provider\u6765\u64CD\u4F5C</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyProvider</span> <span class="token keyword">extends</span> <span class="token class-name">SearchRecentSuggestionsProvider</span> <span class="token punctuation">{</span>
	<span class="token comment">//\u6307\u5B9A\u67E5\u8BE2\u7684authority</span>
	<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> AUTHORITY <span class="token operator">=</span> <span class="token string">&quot;com.charon.MyProvider&quot;</span><span class="token punctuation">;</span>
	<span class="token comment">//\u6307\u5B9A\u6570\u636E\u5E93\u7684\u64CD\u4F5C\u662F\u67E5\u8BE2\u7684\u65B9\u5F0F</span>
	<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MODE <span class="token operator">=</span> DATABASE_MODE_QUERIES<span class="token punctuation">;</span> 
	<span class="token keyword">public</span> <span class="token class-name">MySuggestionProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">setupSuggestions</span><span class="token punctuation">(</span>AUTHORITY<span class="token punctuation">,</span> MODE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">//\u7136\u540E\u91CD\u5199SearchRecentSuggestionsProvider\u4E2D\u7684\u65B9\u6CD5\uFF0C\u6709\u589E\u5220\u6539\u67E5\u56DB\u4E2A\u65B9\u6CD5</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sms_projection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>_ID<span class="token punctuation">,</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">,</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>BODY<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columnNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">BaseColumns</span><span class="token punctuation">.</span>_ID<span class="token punctuation">,</span>
		<span class="token class-name">SearchManager</span><span class="token punctuation">.</span>SUGGEST_COLUMN_TEXT_1<span class="token punctuation">,</span>   <span class="token comment">//\u6307\u5B9A\u641C\u7D22\u81EA\u52A8\u63D0\u793A\u7684\u6846\u7684\u6837\u5F0F</span>
		<span class="token class-name">SearchManager</span><span class="token punctuation">.</span>SUGGEST_COLUMN_TEXT_2<span class="token punctuation">,</span>
		<span class="token class-name">SearchManager</span><span class="token punctuation">.</span>SUGGEST_COLUMN_QUERY<span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//\u8FD9\u4E2A\u53C2\u6570\u80FD\u591F\u8BA9\u70B9\u51FB\u67D0\u4E2A\u641C\u7D22\u63D0\u793A\u7684\u65F6\u5019\u81EA\u52A8\u8BA9\u641C\u7D22\u5185\u5BB9\u53D8\u6210\u70B9\u51FB\u7684\u6761\u76EE\u7684\u5185\u5BB9</span>
	
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Cursor</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> projection<span class="token punctuation">,</span> <span class="token class-name">String</span> selection<span class="token punctuation">,</span>
			<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs<span class="token punctuation">,</span> <span class="token class-name">String</span> sortOrder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>selectionArgs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token class-name">String</span> query <span class="token operator">=</span> selectionArgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token class-name">Uri</span> uri1 <span class="token operator">=</span> <span class="token class-name">Sms</span><span class="token punctuation">.</span>CONTENT_URI<span class="token punctuation">;</span>
			<span class="token class-name">String</span> where <span class="token operator">=</span> <span class="token class-name">Sms</span><span class="token punctuation">.</span>BODY <span class="token operator">+</span> <span class="token string">&quot; like &#39;%&quot;</span> <span class="token operator">+</span> query <span class="token operator">+</span> <span class="token string">&quot;%&#39;&quot;</span><span class="token punctuation">;</span>
			<span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri1<span class="token punctuation">,</span> sms_projection<span class="token punctuation">,</span> where<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">Sms</span><span class="token punctuation">.</span>DATE <span class="token operator">+</span> <span class="token string">&quot; desc &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token function">changeCursor</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token class-name">Cursor</span> <span class="token function">changeCursor</span><span class="token punctuation">(</span><span class="token class-name">Cursor</span> cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">MatrixCursor</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MatrixCursor</span><span class="token punctuation">(</span>columnNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>cursor <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columnValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>_ID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
						cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
						cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>BODY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
						cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">Sms</span><span class="token punctuation">.</span>BODY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//\u70B9\u51FB\u65F6\u5019\u8BA9\u5185\u5BB9\u53D8\u4E3A\u77ED\u4FE1\u5185\u5BB9</span>
				result<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>columnValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> result<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u4E3A\u4E86\u8BA9\u4E0D\u7BA1\u5728\u54EA\u4E2A\u754C\u9762\u53EA\u8981\u70B9\u51FB\u624B\u673A\u7684\u641C\u7D22\u952E\u90FD\u80FD\u591F\u5F39\u51FA\u6211\u4EEC\u7684\u641C\u7D22(\u5168\u5C40\u641C\u7D22)\uFF0C\u9700\u8981\u5728Application\u8282\u70B9\u4E2D\u53BB\u914D\u7F6E\u4E0B\u9762\u7684meta-data</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- \u6307\u5B9A\u6211\u4EEC\u8981\u6FC0\u6D3B\u7684\u662F\u54EA\u4E2ASearchableActivity --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span>
	<span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.app.default_searchable<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.SearchableActivity<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u5728Activtity\u4E2D\u6709\u4E00\u4E2AonSearchRequested\u65B9\u6CD5\uFF0C\u6267\u884C\u6B64\u65B9\u6CD5\u65F6\u80FD\u591F\u6FC0\u6D3B\u641C\u7D22\u6846\uFF0C\u6240\u4EE5\u5728\u70B9\u51FB\u641C\u7D22\u6309\u94AE\u65F6\u6267\u884C\u6B64\u65B9\u6CD5\u5373\u53EF</p></li></ol><hr><ul><li>\u90AE\u7BB1 \uFF1Acharon.chui@gmail.com</li><li>Good Luck!</li></ul>`,4),c=[e];function o(l,u){return s(),a("div",null,c)}var k=n(p,[["render",o],["__file","\u641C\u7D22\u6846.html.vue"]]);export{k as default};
