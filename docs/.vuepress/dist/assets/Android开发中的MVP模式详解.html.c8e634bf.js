import{_ as p,r as o,o as c,c as i,a as n,b as t,d as s,e}from"./app.89e8a229.js";const l={},u=n("h1",{id:"android\u5F00\u53D1\u4E2D\u7684mvp\u6A21\u5F0F\u8BE6\u89E3",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#android\u5F00\u53D1\u4E2D\u7684mvp\u6A21\u5F0F\u8BE6\u89E3","aria-hidden":"true"},"#"),s(" Android\u5F00\u53D1\u4E2D\u7684MVP\u6A21\u5F0F\u8BE6\u89E3")],-1),d={href:"https://github.com/CharonChui/AndroidNote/blob/master/JavaKnowledge/MVC%E4%B8%8EMVP%E5%8F%8AMVVM.md",title:"MVC\u3001MVP\u3001MVVM\u4ECB\u7ECD",target:"_blank",rel:"noopener noreferrer"},k=s("MVC\u3001MVP\u3001MVVM\u4ECB\u7ECD"),r=e(`<p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/android_mvp.jpg?raw=true" alt="image"></p><p>\u5728<code>Android</code>\u5F00\u53D1\u4E2D\uFF0C\u5982\u679C\u4E0D\u6CE8\u91CD\u67B6\u6784\u7684\u8BDD\uFF0C<code>Activity</code>\u7C7B\u5C31\u4F1A\u53D8\u5F97\u6108\u53D1\u5E9E\u5927\u3002\u8FD9\u662F\u56E0\u4E3A\u5728<code>Android</code>\u5F00\u53D1\u4E2D<code>View</code>\u548C\u5176\u4ED6\u7684\u7EBF\u7A0B\u53EF\u4EE5\u5171\u5B58\u4E8E<code>Activity</code>\u5185\u3002\u90A3\u6700\u5927\u7684\u95EE\u9898\u662F\u4EC0\u4E48\u5462\uFF1F \u5176\u5B9E\u5C31\u662F<code>Activity</code>\u4E2D\u540C\u65F6\u5B58\u5728\u4E1A\u52A1\u903B\u8F91\u548C<code>UI</code>\u903B\u8F91\u3002\u8FD9\u5BFC\u81F4\u589E\u52A0\u4E86\u5355\u5143\u6D4B\u8BD5\u548C\u7EF4\u62A4\u7684\u6210\u672C\u3002</p><p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/activity_is_god.png?raw=true" alt="image"></p><p>\u8FD9\u5C31\u662F\u4E3A\u4EC0\u4E48\u8981\u6E05\u6670\u67B6\u6784\u7684\u539F\u56E0\u4E4B\u4E00\u3002\u4E0D\u4EC5\u662F\u56E0\u4E3A<code>Activity</code>\u7C7B\u53D8\u5F97\u81C3\u80BF\uFF0C\u4E5F\u662F\u5176\u4ED6\u7684\u4E00\u4E9B\u95EE\u9898\uFF0C\u4F8B\u5982<code>Activity</code>\u548C<code>Fragment</code>\u76F8\u7ED3\u5408\u65F6\u7684\u751F\u547D\u5468\u671F\u3001\u6570\u636E\u7ED1\u5B9A\u7B49\u7B49\u3002</p><h3 id="mvp\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#mvp\u7B80\u4ECB" aria-hidden="true">#</a> MVP\u7B80\u4ECB</h3><p><code>MVP(Model,View,Presenter)</code></p><ul><li><code>View</code>\uFF1A\u8D1F\u8D23\u5904\u7406\u7528\u6237\u65F6\u95F4\u548C\u89C6\u56FE\u5C55\u73B0\u3002\u5728<code>Android</code>\u4E2D\u5C31\u53EF\u80FD\u662F<code>Activity</code>\u6216\u8005<code>Fragment</code>\u3002</li><li><code>Model</code>\uFF1A \u8D1F\u8D23\u6570\u636E\u8BBF\u95EE\u3002\u6570\u636E\u53EF\u4EE5\u662F\u4ECE\u63A5\u53E3\u6216\u8005\u672C\u5730\u6570\u636E\u5E93\u4E2D\u83B7\u53D6\u3002</li><li><code>Presenter</code>: \u8D1F\u8D23\u8FDE\u63A5<code>View</code>\u548C<code>Model</code>\u3002</li></ul><p>\u7528\u4E00\u53E5\u8BDD\u6765\u8BF4:<code>MVP</code>\u5176\u5B9E\u5C31\u662F\u9762\u5411\u63A5\u53E3\u7F16\u7A0B\uFF0C<code>V</code>\u5B9E\u73B0\u63A5\u53E3\uFF0C<code>P</code>\u4F7F\u7528\u63A5\u53E3\u3002</p><p>\u6E05\u6670\u7684\u67B6\u6784:</p><p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/mvp_a.png?raw=true" alt="image"></p><p>\u4E3E\u4E2A\u6817\u5B50: \u5728<code>Android Studio</code>\u4E2D\u65B0\u5EFA\u4E00\u4E2A<code>Activity</code>\uFF0C\u7CFB\u7EDF\u63D0\u4F9B\u4E86<code>LoginActivity</code>\uFF0C\u76F4\u63A5\u7528\u5B83\u662F\u6781\u597D\u7684\u3002</p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/loginactivity.png?raw=true" width="50%" height="50%"><p>\u4E0D\u5F97\u4E0D\u8BF4\uFF0C<code>Material Design</code>\u7684\u6548\u679C\u771F\u662F\u7F8E\u7F8E\u54D2\uFF01</p><p>\u597D\uFF0C\u90A3\u6211\u4EEC\u5C31\u7528\u7528\u6237\u767B\u5F55\u9875\u6765\u6309\u7167<code>MVP</code>\u7684\u6A21\u5F0F\u5B9E\u73B0\u4E00\u4E0B:</p><ul><li>M: \u5F88\u663E\u7136Model\u5E94\u8BE5\u662F<code>User</code>\u7C7B\u3002</li><li>V: <code>View</code>\u5C31\u662F<code>LoginActivity</code>\u3002</li><li>P: P\u90A3\u6211\u4EEC\u4E00\u4F1A\u5C31\u521B\u5EFA\u4E00\u4E2A<code>LoginPresenter</code>\u7C7B\u3002</li></ul><p>\u9F50\u4E86\uFF0C\u90A3\u63A5\u4E0B\u6765\u5C31\u8BE6\u7EC6\u5206\u6790\u4E0B\u4ED6\u4EEC\u8FD9\u4E09\u90E8\u5206:</p><ul><li><code>User</code>: \u5E94\u8BE5\u6709<code>email</code>, <code>password</code>, <code>boolean login(email, password)</code>\u3002</li><li><code>LoginActivity</code>:\u70B9\u51FB\u767B\u5F55\u5E94\u8BE5\u8981\u51FA<code>loading</code>\u9875\u3002\u767B\u5F55\u6210\u529F\u540E\u8981\u8FDB\u5165\u4E0B\u4E00\u4E2A\u9875\u9762\u3002\u5982\u679C\u767B\u5F55\u5931\u8D25\u5E94\u8BE5\u5F39<code>toast</code>\u63D0\u793A\u3002\u90A3\u5C31\u9700\u8981<code>void showLoading()</code>\uFF0C<code>void hideLoading()</code>\uFF0C<code>void showErrorTip()</code>,<code>void doLoginSuccess()</code>\u8FD9\u56DB\u4E2A\u65B9\u6CD5\u3002</li><li><code>LoginPresenter</code>:\u8FD9\u662F<code>Model</code>\u548C<code>View</code>\u7684\u6865\u6881\u3002\u4ED6\u9700\u8981\u505A\u7684\u5904\u7406\u4E1A\u52A1\u903B\u8F91\uFF0C\u76F4\u63A5\u4E0E<code>Model</code>\u6253\u4EA4\u9053\uFF0C\u7136\u540E\u5C06<code>UI</code>\u7684\u903B\u8F91\u4EA4\u7ED9<code>LoginActivity</code>\u5904\u7406\u3002 \u90A3\u600E\u4E48\u505A\u5462\uFF1F \u6309\u7167\u6211\u4E0A\u9762\u603B\u7ED3\u7684\u90A3\u4E00\u53E5\u8BDD\uFF0C\u3001<code>MVP</code>\u5176\u5B9E\u5C31\u662F\u9762\u5411\u63A5\u53E3\u7F16\u7A0B\uFF0C<code>V</code>\u5B9E\u73B0\u63A5\u53E3\uFF0C<code>P</code>\u4F7F\u7528\u63A5\u53E3\u3002\u5F88\u663E\u7136\u6211\u4EEC\u9700\u8981\u63D0\u4F9B\u4E00\u4E2A\u63A5\u53E3\u3002\u90A3\u5C31\u65B0\u5EFA\u4E00\u4E2A<code>ILoginView</code>\u7684\u63A5\u53E3\u3002\u8FD9\u91CC\u9762\u6709\u54EA\u4E9B\u65B9\u6CD5\u5462\uFF1F \u5F53\u7136\u662F\u4E0A\u9762\u6211\u4EEC\u5728\u5206\u6790<code>LoginActiity</code>\u65F6\u63D0\u51FA\u7684\u90A3\u56DB\u4E2A\u65B9\u6CD5\u3002\u8FD9\u6837<code>LoginActivity</code>\u76F4\u63A5\u5B9E\u73B0<code>ILoginView</code>\u63A5\u53E3\u5C31\u597D\u3002</li></ul><p>\u5F00\u59CB\u505A:</p><ul><li><p>\u5148\u628A<code>Model</code>\u505A\u597D\u5427\uFF0C\u521B\u5EFA<code>User</code>\u7C7B\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> email<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// do login request..</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u521B\u5EFA<code>ILoginView</code>\u63A5\u53E3\uFF0C\u5B9A\u4E49\u767B\u5F55\u6240\u9700\u8981\u7684<code>ui</code>\u903B\u8F91\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILoginView</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">showErrorTip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">doLoginSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u521B\u5EFA<code>LoginPresenter</code>\u7C7B\uFF0C\u4F7F\u7528<code>ILoginView</code>\u63A5\u53E3\uFF0C\u90A3\u8BE5\u7C7B\u4E3B\u8981\u6709\u4EC0\u4E48\u529F\u80FD\u5462\uFF1F \u5B83\u4E3B\u8981\u662F\u5904\u7406\u4E1A\u52A1\u903B\u8F91\u7684\uFF0C \u5BF9\u4E8E\u767B\u5F55\u7684\u8BDD\uFF0C\u5F53\u7136\u662F\u7528\u6237\u5728<code>UI</code>\u9875\u9762\u8F93\u5165\u90AE\u7BB1\u548C\u5BC6\u7801\uFF0C\u7136\u540E<code>Presenter</code>\u53BB\u5F00\u7EBF\u7A0B\u3001\u8BF7\u6C42\u63A5\u53E3\u3002\u7136\u540E\u5F97\u5230\u767B\u5F55\u7ED3\u679C\u518D\u53BB\u8BA9<code>UI</code>\u663E\u793A\u5BF9\u5E94\u7684\u89C6\u56FE\u3002\u90A3\u81EA\u7136\u5C31\u662F\u6709\u4E00\u4E2A<code>void login(String email, String passowrd)</code>\u7684\u65B9\u6CD5\u4E86</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginPresenter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">ILoginView</span> mLoginView<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">LoginPresenter</span><span class="token punctuation">(</span><span class="token class-name">ILoginView</span> loginView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mLoginView <span class="token operator">=</span> loginView<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//</span>
            mLoginView<span class="token punctuation">.</span><span class="token function">showErrorTip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mLoginView<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// do network request....</span>
        <span class="token comment">// ....</span>
        <span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">boolean</span> login <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>login<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                mLoginView<span class="token punctuation">.</span><span class="token function">doLoginSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                mLoginView<span class="token punctuation">.</span><span class="token function">showErrorTip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            mLoginView<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">onFailde</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mLoginView<span class="token punctuation">.</span><span class="token function">showErrorTip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mLoginView<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u521B\u5EFA<code>LoginActivity</code>\uFF0C\u5B9E\u73B0<code>ILoginView</code>\u7684\u63A5\u53E3\uFF0C\u7136\u540E\u5185\u90E8\u8C03\u7528<code>LoginPresenter</code>\u6765\u5904\u7406\u4E1A\u52A1\u903B\u8F91\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token keyword">implements</span> <span class="token class-name">ILoginView</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">LoginPresenter</span> mLoginPresenter<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">AutoCompleteTextView</span> mEmailView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> mPasswordView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">View</span> mProgressView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">View</span> mLoginButton<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_login<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mEmailView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">AutoCompleteTextView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mPasswordView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mLoginButton <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>email_sign_in_button<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mProgressView <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>login_progress<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mLoginPresenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoginPresenter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mLoginButton<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                mLoginPresenter<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>mEmailView<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mPasswordView<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mProgressView<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">View</span><span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mProgressView<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">View</span><span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showErrorTip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;login faled&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doLoginSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;login success&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><p>\u4E0A\u9762\u53EA\u662F\u629B\u7816\u5F15\u7389\u3002<code>MVP</code>\u7684\u6709\u70B9\u5341\u5206\u660E\u663E\uFF0C\u5C31\u662F\u4EE3\u7801\u89E3\u8026\u3001\u53EF\u4EE5\u8BA9\u903B\u8F91\u6E05\u6670\uFF0C\u4F46\u662F\u540C\u6837\u5B83\u4E5F\u4F1A\u6709\u7F3A\u70B9\uFF0C\u5B83\u7684\u7F3A\u70B9\u5C31\u662F\u9879\u76EE\u7684\u590D\u6742\u7A0B\u5EA6\u4F1A\u589E\u52A0\uFF0C\u9879\u76EE\u4E2D\u4F1A\u591A\u51FA\u5F88\u591A\u7C7B\u3002 \u4E4B\u524D\u5F88\u591A\u4EBA\u90FD\u5728\u8BA8\u8BBA\u8BE5\u5982\u4F55\u53BB\u6B63\u786E\u7684\u8BBE\u8BA1\u4F7F\u7528<code>MVP</code>\u6765\u907F\u514D\u5B83\u7684\u7F3A\u70B9\uFF0C\u4F17\u8BF4\u7EB7\u7EAD\uFF0C\u5F88\u591A\u4EBA\u8BA8\u8BBA\u7684\u4F60\u6B7B\u6211\u6D3B\u3002\u76F4\u5230<code>Google</code>\u53D1\u5E03\u4E86<code>MVP\u67B6\u6784\u84DD\u56FE</code>\uFF0C\u5927\u5BB6\u624D\u610F\u8BC6\u5230\u8FD9\u624D\u662F\u89C4\u8303\u3002</p>`,21),v=s("\u9879\u76EE\u5730\u5740:"),m={href:"https://github.com/googlesamples/android-architecture",target:"_blank",rel:"noopener noreferrer"},b=s("android-architecture"),w=n("code",null,"Google",-1),g=s("\u5C06\u8BE5\u9879\u76EE\u547D\u540D\u4E3A"),y=n("code",null,"Android",-1),h=s("\u7684\u67B6\u6784\u84DD\u56FE\uFF0C\u6211\u60F3\u4ECE\u540D\u5B57\u4E0A\u5DF2\u53EF\u4EE5\u770B\u7A7F\u4E00\u5207\u3002"),f=e(`<p>\u5728\u5B83\u7684\u5B98\u65B9\u4ECB\u7ECD\u4E2D\u662F\u8FD9\u6837\u8BF4\u7684:</p><blockquote><p>The Android framework offers a lot of flexibility when it comes to defining how to organize and architect an Android app. This freedom, whilst very valuable, can also result in apps with large classes, inconsistent naming and architectures (or lack of) that can make testing, maintaining and extending difficult.</p></blockquote><blockquote><p>Android Architecture Blueprints is meant to demonstrate possible ways to help with these common problems. In this project we offer the same application implemented using different architectural concepts and tools.</p></blockquote><blockquote><p>You can use these samples as a reference or as a starting point for creating your own apps. The focus here is on code structure, architecture, testing and maintainability. However, bear in mind that there are many ways to build apps with these architectures and tools, depending on your priorities, so these shouldn&#39;t be considered canonical examples. The UI is deliberately kept simple.</p></blockquote><p>\u5DF2\u5B8C\u6210\u7684\u793A\u4F8B:</p><ul><li>todo-mvp/ - Basic Model-View-Presenter architecture.</li><li>todo-mvp-loaders/ - Based on todo-mvp, fetches data using Loaders.</li><li>todo-mvp-databinding/ - Based on todo-mvp, uses the Data Binding Library.</li><li>todo-mvp-clean/ - Based on todo-mvp, uses concepts from Clean Architecture.</li><li>todo-mvp-dagger/ - Based on todo-mvp, uses Dagger2 for Dependency Injection</li><li>todo-mvp-contentproviders/ - Based on todo-mvp-loaders, fetches data using Loaders and uses Content Providers</li><li>todo-mvp-rxjava/ - Based on todo-mvp, uses RxJava for concurrency and data layer abstraction.</li></ul><p>\u6211\u4EEC\u63A5\u4E0B\u6765\u5C31\u7528<code>todo-mvp</code>\u6765\u8FDB\u884C\u5206\u6790\uFF0C\u8FD9\u4E2A\u5E94\u7528\u975E\u5E38\u7B80\u5355\uFF0C\u4E3B\u8981\u6709\u4EE5\u4E0B\u51E0\u4E2A\u529F\u80FD:</p><ul><li>\u5217\u8868\u9875:\u5C55\u793A\u6240\u6709\u7684<code>todo</code>\u9879</li><li>\u6DFB\u52A0\u9875:\u6DFB\u52A0<code>todo</code>\u9879</li><li>\u8BE6\u60C5\u9875:\u67E5\u770B<code>todo</code>\u9879\u7684\u8BE6\u60C5</li><li>\u7EDF\u8BA1\u9875:\u67E5\u770B\u5F53\u524D\u6240\u6709\u5DF2\u5B8C\u6210<code>todo</code>\u53CA\u672A\u5B8C\u6210\u9879\u7684\u7EDF\u8BA1\u6570\u636E</li></ul><p>\u4EE3\u7801\u5E76\u4E0D\u591A:</p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/google_mvp.png?raw=true" width="50%" height="50%"><p>\u529F\u80FD\u4E5F\u6BD4\u8F83\u7B80\u5355:</p><p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/google_todo_main.png?raw=true" width="40%" height="40%"> <img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/google_todp_add.png?raw=true" width="40%" height="40%"><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/google_todo_list.png?raw=true" width="40%" height="40%"> <img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/google_todo_delete.png?raw=true" width="40%" height="40%"></p><p>\u6211\u4EEC\u5148\u4ECE\u4E24\u4E2A<code>Base</code>\u7C7B\u5F00\u59CB\u770B\uFF0C\u5206\u522B\u662F<code>BaseView</code>\u4EE5\u53CA<code>BasePresenter</code>\u7C7B\u3002</p><p><code>BaseView</code>\u7C7B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseView</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">setPresenter</span><span class="token punctuation">(</span><span class="token class-name">T</span> presenter<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>BaseView</code>\u4E2D\u7684<code>setPresenter()</code>\u662F\u5C06<code>Presenter</code>\u7684\u5B9E\u4F8B\u4F20\u5165\u5230<code>View</code>\u4E2D\u3002<br><code>BasePresenter</code>\u7C7B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BasePresenter</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>BasePresenter</code>\u4E2D\u53EA\u6709\u4E00\u4E2A<code>start()</code>\u65B9\u6CD5\uFF0C\u4ECE\u540D\u5B57\u4E0A\u6211\u4EEC\u5C31\u80FD\u770B\u51FA\u4ED6\u7684\u4F5C\u7528\u3002</p><p>\u63A5\u4E0B\u6765\u7EE7\u7EED\u770B\u4E00\u4E0B\u9879\u76EE\u7684\u5165\u53E3<code>Activity</code>\uFF0C<code>TaskDetailActivity</code>\u7684\u5B9E\u73B0:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TaskDetailActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> EXTRA_TASK_ID <span class="token operator">=</span> <span class="token string">&quot;TASK_ID&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>taskdetail_act<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Set up the toolbar.</span>
        <span class="token class-name">Toolbar</span> toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setSupportActionBar</span><span class="token punctuation">(</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ActionBar</span> ab <span class="token operator">=</span> <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ab<span class="token punctuation">.</span><span class="token function">setDisplayHomeAsUpEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ab<span class="token punctuation">.</span><span class="token function">setDisplayShowHomeEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Get the requested task id</span>
        <span class="token class-name">String</span> taskId <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span>EXTRA_TASK_ID<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">TaskDetailFragment</span> taskDetailFragment <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TaskDetailFragment</span><span class="token punctuation">)</span> <span class="token function">getSupportFragmentManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findFragmentById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>contentFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>taskDetailFragment <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u5BF9\u5E94\u7684Fragment</span>
            taskDetailFragment <span class="token operator">=</span> <span class="token class-name">TaskDetailFragment</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">ActivityUtils</span><span class="token punctuation">.</span><span class="token function">addFragmentToActivity</span><span class="token punctuation">(</span><span class="token function">getSupportFragmentManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    taskDetailFragment<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>contentFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Create the presenter\uFF0C\u56E0\u4E3APresenter\u662FM\u548CV\u7684\u8FDE\u63A5\u6865\uFF0C\u6240\u4EE5\u5728\u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E2D\u4F1A\u4F20\u5165TasksRepository</span>
        <span class="token keyword">new</span> <span class="token class-name">TaskDetailPresenter</span><span class="token punctuation">(</span>
                taskId<span class="token punctuation">,</span>
                <span class="token class-name">Injection</span><span class="token punctuation">.</span><span class="token function">provideTasksRepository</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                taskDetailFragment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onSupportNavigateUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">onBackPressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\u8FD9\u91CC<code>Activity</code>\u76F8\u5F53\u4E8E\u4E00\u4E2A\u7BA1\u7406\u7C7B\uFF0C\u91CC\u9762\u63A7\u5236\u7740<code>MVP</code>\u4E2D\u7684<code>V</code>\u548C<code>P</code>,\u4E0A\u9762\u7684\u4EE3\u7801\u4E3B\u8981\u505A\u4E86\u4E24\u90E8\u5206:</p><ul><li>\u521B\u5EFA\u5BF9\u5E94\u7684<code>Fragment</code></li><li>\u521B\u5EFA\u5BF9\u5E94\u7684<code>Presenter</code></li></ul><p>\u8FD9\u91CC\u5206\u522B\u770B\u4E00\u4E0B<code>TaskDetailFragment</code>\u548C<code>TaskDetailPresenter</code>\u7684\u6E90\u7801:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TaskDetailFragment</span> <span class="token keyword">extends</span> <span class="token class-name">Fragment</span> <span class="token keyword">implements</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>View</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>Presenter</span> mPresenter<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">TaskDetailFragment</span> <span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> taskId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Bundle</span> arguments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arguments<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>ARGUMENT_TASK_ID<span class="token punctuation">,</span> taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TaskDetailFragment</span> fragment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TaskDetailFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fragment<span class="token punctuation">.</span><span class="token function">setArguments</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> fragment<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8C03\u7528Presenter.start()\u65B9\u6CD5</span>
        mPresenter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Nullable</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">View</span> <span class="token function">onCreateView</span><span class="token punctuation">(</span><span class="token class-name">LayoutInflater</span> inflater<span class="token punctuation">,</span> <span class="token class-name">ViewGroup</span> container<span class="token punctuation">,</span>
                             <span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPresenter</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>Presenter</span> presenter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u5C06Prsenter\u4F20\u9012\u7ED9V\u4E2D </span>
        mPresenter <span class="token operator">=</span> <span class="token function">checkNotNull</span><span class="token punctuation">(</span>presenter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53CA</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TaskDetailPresenter</span> <span class="token keyword">implements</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>Presenter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">TasksRepository</span> mTasksRepository<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>View</span> mTaskDetailView<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mTaskId<span class="token punctuation">;</span>

    <span class="token comment">// \u628AM\u548CV\u4F20\u9012\u8FDB\u6765</span>
    <span class="token keyword">public</span> <span class="token class-name">TaskDetailPresenter</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> taskId<span class="token punctuation">,</span>
                               <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">TasksRepository</span> tasksRepository<span class="token punctuation">,</span>
                               <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>View</span> taskDetailView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mTaskId <span class="token operator">=</span> taskId<span class="token punctuation">;</span>
        mTasksRepository <span class="token operator">=</span> <span class="token function">checkNotNull</span><span class="token punctuation">(</span>tasksRepository<span class="token punctuation">,</span> <span class="token string">&quot;tasksRepository cannot be null!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTaskDetailView <span class="token operator">=</span> <span class="token function">checkNotNull</span><span class="token punctuation">(</span>taskDetailView<span class="token punctuation">,</span> <span class="token string">&quot;taskDetailView cannot be null!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5C06\u8BE5Presenter\u8BBE\u7F6E\u7ED9V</span>
        mTaskDetailView<span class="token punctuation">.</span><span class="token function">setPresenter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u8C03\u7528\u83B7\u53D6\u6570\u636E\u7684\u65B9\u6CD5</span>
        <span class="token function">openTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\u4E0A\u9762\u5206\u522B\u5B9E\u73B0\u4E86<code>TaskDetailContract</code>\u7C7B\u4E2D\u7684<code>Presenter</code>\u548C<code>View</code>\u63A5\u53E3\uFF0C\u800C\u4E0D\u662F<code>BasePresenter</code>\u548C<code>BaseView</code>\u4E2D\u7684\u63A5\u53E3\uFF0C\u90A3\u8FD9\u4E2A<code>TaskDetailContract</code>\u7C7B\u662F\u4EC0\u4E48\u5462\uFF1F</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * This specifies the contract between the view and the presenter.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TaskDetailContract</span> <span class="token punctuation">{</span>

    <span class="token keyword">interface</span> <span class="token class-name">View</span> <span class="token keyword">extends</span> <span class="token class-name">BaseView</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Presenter</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

        <span class="token keyword">void</span> <span class="token function">setLoadingIndicator</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> active<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showMissingTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">hideTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">hideDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showDescription</span><span class="token punctuation">(</span><span class="token class-name">String</span> description<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showCompletionStatus</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> complete<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showEditTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showTaskDeleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showTaskMarkedComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">showTaskMarkedActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">boolean</span> <span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">interface</span> <span class="token class-name">Presenter</span> <span class="token keyword">extends</span> <span class="token class-name">BasePresenter</span> <span class="token punctuation">{</span>

        <span class="token keyword">void</span> <span class="token function">editTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">deleteTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">completeTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">activateTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6309\u7167\u4E0A\u9762\u63CF\u8FF0\u7684\u4ECB\u7ECD\u53EF\u4EE5\u770B\u51FA\u901A\u8FC7\u8FD9\u4E2A\u8FDE\u63A5\u7C7B\u5C06<code>VP</code>\u8054\u7CFB\u5230\u4E86\u4E00\u8D77\uFF0C\u5B83\u7EDF\u4E00\u7BA1\u7406<code>view</code>\u548C<code>presenter</code>\u4E2D\u7684\u6240\u6709\u63A5\u53E3\uFF0C\u8FD9\u6837\u6BD4\u8D77\u5206\u5F00\u5199\u4F1A\u66F4\u52A0\u6E05\u6670\u3002</p><p>\u5206\u6790\u5B8C<code>VP</code>\u4E4B\u540E\u6211\u4EEC\u7EE7\u7EED\u770B\u4E00\u4E0B<code>TaskDetailPresenter</code>\u7C7B\uFF0C\u56E0\u4E3A<code>Presenter</code>\u662F<code>MV</code>\u7684\u6865\u6881\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">TaskDetailPresenter</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> taskId<span class="token punctuation">,</span>
                               <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">TasksRepository</span> tasksRepository<span class="token punctuation">,</span>
                               <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">TaskDetailContract<span class="token punctuation">.</span>View</span> taskDetailView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mTaskId <span class="token operator">=</span> taskId<span class="token punctuation">;</span>
        mTasksRepository <span class="token operator">=</span> <span class="token function">checkNotNull</span><span class="token punctuation">(</span>tasksRepository<span class="token punctuation">,</span> <span class="token string">&quot;tasksRepository cannot be null!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTaskDetailView <span class="token operator">=</span> <span class="token function">checkNotNull</span><span class="token punctuation">(</span>taskDetailView<span class="token punctuation">,</span> <span class="token string">&quot;taskDetailView cannot be null!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mTaskDetailView<span class="token punctuation">.</span><span class="token function">setPresenter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">openTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">openTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>mTaskId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mTaskDetailView<span class="token punctuation">.</span><span class="token function">showMissingTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// \u63A7\u5236V\u663E\u793AUI</span>
        mTaskDetailView<span class="token punctuation">.</span><span class="token function">setLoadingIndicator</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u901A\u8FC7M\u53BB\u83B7\u53D6\u6570\u636E</span>
        mTasksRepository<span class="token punctuation">.</span><span class="token function">getTask</span><span class="token punctuation">(</span>mTaskId<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TasksDataSource<span class="token punctuation">.</span>GetTaskCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTaskLoaded</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// The view may not be able to handle UI updates anymore</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mTaskDetailView<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                mTaskDetailView<span class="token punctuation">.</span><span class="token function">setLoadingIndicator</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    mTaskDetailView<span class="token punctuation">.</span><span class="token function">showMissingTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">showTask</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataNotAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// The view may not be able to handle UI updates anymore</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mTaskDetailView<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                mTaskDetailView<span class="token punctuation">.</span><span class="token function">showMissingTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u5B83\u7684\u6784\u9020\u51FD\u6570\u4E2D\u4F20\u5165\u4E86\u4E00\u4E2A<code>TasksRepository</code>\uFF0C\u8FD9\u4E2A\u5C31\u662F<code>Model</code>\u5C42\u3002\u800C\u5728\u8BE5<code>Presenter</code>\u4E2D\u7684<code>start()</code>\u65B9\u6CD5\u56DE\u53BB\u8C03\u7528\u83B7\u53D6\u6570\u636E\u7684\u65B9\u6CD5\u3002</p><p>\u6211\u4EEC\u7EE7\u7EED\u770B\u4E00\u4E0B<code>M</code>\u5C42<code>TasksRepository</code>\u7684\u5B9E\u73B0:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Concrete implementation to load tasks from the data sources into a cache.
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * For simplicity, this implements a dumb synchronisation between locally persisted data and data
 * obtained from the server, by using the remote data source only if the local database doesn&#39;t
 * exist or is empty.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TasksRepository</span> <span class="token keyword">implements</span> <span class="token class-name">TasksDataSource</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5148\u770B\u4E00\u4E0B<code>TasksDataSource</code>\u63A5\u53E3:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Main entry point for accessing tasks data.
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * For simplicity, only getTasks() and getTask() have callbacks. Consider adding callbacks to other
 * methods to inform the user of network/database errors or successful operations.
 * For example, when a new task is created, it&#39;s synchronously stored in cache but usually every
 * operation on database or network should be executed in a different thread.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TasksDataSource</span> <span class="token punctuation">{</span>

    <span class="token keyword">interface</span> <span class="token class-name">LoadTasksCallback</span> <span class="token punctuation">{</span>

        <span class="token keyword">void</span> <span class="token function">onTasksLoaded</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> tasks<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">onDataNotAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">interface</span> <span class="token class-name">GetTaskCallback</span> <span class="token punctuation">{</span>

        <span class="token keyword">void</span> <span class="token function">onTaskLoaded</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">onDataNotAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">getTasks</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">LoadTasksCallback</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span> taskId<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">GetTaskCallback</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">saveTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Task</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">completeTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Task</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">completeTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span> taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">activateTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Task</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">activateTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span> taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">clearCompletedTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">refreshTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">deleteAllTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">deleteTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span> taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u51FA<code>M</code>\u5C42\u88AB\u8D4B\u4E88\u4E86\u6570\u636E\u83B7\u53D6\u7684\u529F\u80FD\uFF0C\u4E0E\u4E4B\u524D\u6211\u4EEC\u5199\u7684<code>M</code>\u5C42\u53EA\u5B9A\u4E49\u5B9E\u4F53\u5BF9\u8C61\u622A\u7136\u4E0D\u540C\uFF0C\u6570\u636E\u7684\u589E\u5220\u6539\u67E5\u90FD\u662F<code>M</code>\u5C42\u5B9E\u73B0\u7684\u3002<code>Presenter</code>\u53EA\u9700\u8981\u8C03\u7528<code>M</code>\u5C42\u7684\u65B9\u6CD5\u5373\u53EF\u3002\u8FD9\u6837<code>model\u3001presenter\u3001view</code>\u90FD\u53EA\u5904\u7406\u5404\u81EA\u7684\u4EFB\u52A1\uFF0C\u6B64\u79CD\u5B9E\u73B0\u786E\u5B9E\u662F\u5355\u4E00\u804C\u8D23\u6700\u597D\u7684\u8BE0\u91CA\u3002</p><p>\u8FD9\u91CC\u6211\u4EEC\u5C31\u4EE5\u4E0A\u9762\u7528\u5230\u7684<code>getTasks()</code>\u65B9\u6CD5\u4E3A\u4F8B\u6765\u4ECB\u7ECD\u4E00\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token keyword">final</span> <span class="token class-name">String</span> taskId<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token keyword">final</span> <span class="token class-name">GetTaskCallback</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">checkNotNull</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">checkNotNull</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u4ECE\u7F13\u5B58\u4E2D\u83B7\u53D6\u6570\u636E</span>
        <span class="token class-name">Task</span> cachedTask <span class="token operator">=</span> <span class="token function">getTaskWithId</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Respond immediately with cache if available</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedTask <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            callback<span class="token punctuation">.</span><span class="token function">onTaskLoaded</span><span class="token punctuation">(</span>cachedTask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Load from server/persisted if needed.</span>

        <span class="token comment">// Is the task in the local data source? If not, query the network.</span>
        mTasksLocalDataSource<span class="token punctuation">.</span><span class="token function">getTask</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GetTaskCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTaskLoaded</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Do in memory cache update to keep the app UI up to date</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>mCachedTasks <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    mCachedTasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                mCachedTasks<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>
                callback<span class="token punctuation">.</span><span class="token function">onTaskLoaded</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataNotAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// \u670D\u52A1\u5668\u7684\u6570\u636E\u6E90</span>
                mTasksRemoteDataSource<span class="token punctuation">.</span><span class="token function">getTask</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GetTaskCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTaskLoaded</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// Do in memory cache update to keep the app UI up to date</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>mCachedTasks <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            mCachedTasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        mCachedTasks<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        callback<span class="token punctuation">.</span><span class="token function">onTaskLoaded</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataNotAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        callback<span class="token punctuation">.</span><span class="token function">onDataNotAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684\u6CE8\u91CA\u8BF4\u7684\u975E\u5E38\u660E\u767D\u4E86\uFF0C\u8FD9\u91CC\u5C31\u4E0D\u53BB\u4ED4\u7EC6\u770B\u4E86\u3002</p><p>\u4E0B\u9762\u7528\u4E00\u5F20\u56FE\u6765\u603B\u7ED3\u4E00\u4E0B:</p><p><img src="https://raw.githubusercontent.com/CharonChui/Pictures/master/google_todo_mvp.png?raw=true" alt="image"></p><p>\u7531\u4E8E\u67B6\u6784\u7684\u5F15\u5165\uFF0C\u867D\u7136\u4EE3\u7801\u91CF\u6709\u4E86\u4E00\u5B9A\u7684\u4E0A\u5347\uFF0C\u4F46\u662F\u529F\u80FD\u5206\u79BB\u7684\u975E\u5E38\u6E05\u6670\u660E\u786E\uFF0C\u800C\u4E14\u6BCF\u4E2A\u90E8\u5206\u90FD\u53EF\u4EE5\u8FDB\u884C\u5355\u72EC\u7684\u6D4B\u8BD5\uFF0C\u5BF9\u4E8E\u540E\u671F\u7684\u6269\u5C55\u7EF4\u62A4\u4F1A\u66F4\u52A0\u7B80\u5355\u5BB9\u6613\u3002</p><hr><ul><li>\u90AE\u7BB1 \uFF1Acharon.chui@gmail.com</li><li>Good Luck!</li></ul>`,45);function T(V,P){const a=o("ExternalLinkIcon");return c(),i("div",null,[u,n("p",null,[n("a",d,[k,t(a)])]),r,n("p",null,[v,n("a",m,[b,t(a)]),w,g,y,h]),f])}var _=p(l,[["render",T],["__file","Android\u5F00\u53D1\u4E2D\u7684MVP\u6A21\u5F0F\u8BE6\u89E3.html.vue"]]);export{_ as default};
